# values.yaml

vault:
  fullnameOverride: bankvault

  server:
    enabled: true

    tls:
      enabled: true

      # LÃ¥t charten generera TLS-material (secret med cert + ca)
      secretName: ""          # tomt => chart genererar Ã¥t dig
      generate: true

      ca:
        subject: "/CN=vault-ca"

    listener:
      tcp:
        address: "0.0.0.0:8200"
        tls_disable: false

  # --- Bank-Vaults sidecars (unsealer + configurer) ---
  bankVaults:
    enabled: true

    tls:
      enabled: true
      # samma secret som servern anvÃ¤nder; nÃ¤r secretName="" anvÃ¤nder
      # chartens defaults (auto-genererad secret)
      secretName: ""

    # Det hÃ¤r blir bank-vaults konfigfilen som mountas in i configurer
    config:
      vault:
        address: https://127.0.0.1:8200
        caCert: /vault/tls/ca.crt

        # ğŸ”§ Viktigt: motsvarar VAULT_SKIP_VERIFY=true fÃ¶r bank-vaults klienten
        # (namnet kan vara 'tlsSkipVerify' eller 'skipVerify' beroende pÃ¥ version;
        # bÃ¶rja med tlsSkipVerify â€“ funkar i de flesta exempel).
        tlsSkipVerify: true

      unsealConfig:
        options:
          preFlightChecks: true
        kubernetes:
          # ğŸ”§ Viktigt: lÃ¤gg unseal-hemligheten i *bankvault* namespace
          secretNamespace: bankvault
          secretName: bank-vaults

      # om du vill ha metrics kvar
      enableMetrics: true

  # (valfritt extra: explicita args till unsealer â€“ bra om du vill se det tydligt)
  unsealer:
    args:
      - --mode
      - k8s
      - --k8s-secret-namespace
      - bankvault        # inte 'default' lÃ¤ngre
      - --k8s-secret-name
      - bank-vaults

vault-operator:
  enabled: true

vault-secrets-webhook:
  enabled: true
